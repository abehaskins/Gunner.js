!function(){"use strict";var a,b,c,d=function(d){this.url="string"==typeof d?d:!1,this.initialData="object"==typeof d?d:!1,this.reloaderStrs={},this.rawData=[],this.projectileStr="*",this.fetches=0,this.limitInt=1,this.delayInt=0;var e,f=this;return this.fire=function(a){f._fetch(a)},this.rapidfire=function(a){f._fetch(function(b){f._each(b,function(b){a(b)})})},this.reloader=function(a){return f.reloaderStrs=a,f},this.limit=function(a){return f.limitInt=a,f},this.fetcher=function(a){return f.fetcherFunc=a,f},this.delay=function(a){return f.delayInt=a,f},this.projectile=function(a){return f.projectileStr=a,f},this.recoil=function(a){return f._getField(f.rawData,f.projectileStr,a)},this.getter=function(a){return f._getterFunc=a,f},this._fetch=function(a,b,c){return f.limitInt&&f.fetches++==f.limitInt?void a(b,f):(f.fetcherFunc&&f.fetcherFunc(f.fetches,f.limitInt),c=c?c:{},void(f.url?f._getterFunc(f.url,c,a).then(f._processIncoming):f._processIncoming(f.initialData,a)))},this._processIncoming=function(a,b){f._defer();f.rawData.push(a);var c=f._getField([a],f.projectileStr);e||(e=[]);c.length;f._each(c,function(a){e.push(a)}),f._reload(a,e,b)},this._reload=function(a,b,c){var d={},e=!1;for(var g in f.reloaderStrs){{f.reloaderStrs[g]}d[g]=f._getField([a],f.reloaderStrs[g])[0],e=d[g]||e}return e&&f.url?void setTimeout(function(){f._fetch(c,b,d)},f.delayInt):void c(b,f)},this._getField=function(a,b,c){for(var d=b.split("."),e=[],g=[],h=function(a,b){g.push(a),a==c&&e.push(b)},i=0;i<d.length;i++){var j=d[i];g=[];for(var k=0;k<a.length;k++){var l=a[k];"*"==j?f._each(l,h):l[j]&&(g.push(l[j]),l[j]==c&&e.push(l))}a=g}return c?e:a},this._each=function(a,b){var c;if(f._isArray(a))for(c=0;c<a.length;c++)b(a[c],a,c);else for(c in a)b(a[c],a,c)},this._getURL=function(d,e,g){var h=f._defer();if(a)return b.get(d+"?"+c.stringify(e),function(a,b,c){h.resolve(JSON.parse(c),g)}),h.promise;var i=[],j="";for(var k in e)i.push(k+"="+e[k]);i.length&&(j="?"+i.join("&"));var l=function(a){h.resolve(JSON.parse(a.responseText||a.currentTarget.responseText),g)},m=new XMLHttpRequest;return m.onload=l,m.open("get",d+j,!0),m.send(),h.promise},this._getterFunc=this._getURL,this._defer=function(){var a={};return a.promise={then:function(b){a.callback=b,a.resolved&&a.finish()}},a.resolve=function(){a.args=arguments,a.callback&&a.finish(),a.resolved=!0},a.finish=function(){a.callback.apply(f,a.args)},a},this._isArray=function(a){return"[object Array]"==toString.call(a)},this},e=this;"undefined"!=typeof module&&module.exports?(e&&(e.Cannon=d),module.exports=d,a=!0,b=require("request"),c=require("querystring")):(e.Cannon=d,a=!1)}();